<!DOCTYPE html>
<html lang='en' data-theme='corporate-blue'>
<head>
    <meta charset='UTF-8'/>
    <meta content='width=device-width, initial-scale=1.0' name='viewport'/>

    <!-- SEO & META TAGS -->
    <title>CSV to JSON Converter | JKM Edit</title>
    <meta name="description" content="Convert CSV files to JSON format instantly. Free online developer tool by JKM Edit."/>
    
    <!-- THEME SCRIPT -->
    <script>
        (function() {
            try {
                const theme = localStorage.getItem('jkm-edit-theme') || 'corporate-blue';
                const mode = localStorage.getItem('jkm-edit-mode') || 'light';
                document.documentElement.setAttribute('data-theme', theme);
                if (mode === 'dark') document.documentElement.classList.add('dark-mode');
            } catch (e) {}
        })();
    </script>

    <!-- FONTS & ICONS -->
    <link href='https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;900&family=Fira+Code:wght@400;500&display=swap' rel='stylesheet'/>
    <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css' rel='stylesheet'/>
    
    <!-- LIBRARY: PapaParse (Best for CSV parsing) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

    <style>
        /* --- VARIABLES & RESET --- */
        :root { 
            font-family: 'Poppins', sans-serif; 
            --primary-color: #0052cc; 
            --secondary-color: #0747a6; 
            --bg-color: #f4f5f7; 
            --surface-color: #ffffff; 
            --text-color: #172b4d; 
            --border-color: #dfe1e6;
            --code-bg: #282c34;
            --code-text: #abb2bf;
            --gradient: linear-gradient(45deg, var(--primary-color), #0065ff); 
        }
        
        html.dark-mode { 
            --bg-color: #121212; 
            --surface-color: #1e1e1e; 
            --text-color: #e0e0e0; 
            --border-color: #333;
        }

        html, body { margin: 0; min-height: 100vh; display: flex; flex-direction: column; background-color: var(--bg-color); color: var(--text-color); }
        *, *::before, *::after { box-sizing: border-box; }
        .hidden { display: none !important; }

        /* --- HEADER --- */
        .main-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem; background: var(--surface-color); box-shadow: 0 2px 10px rgba(0,0,0,0.1); border-bottom: 3px solid var(--primary-color); }
        .logo-container { display: flex; align-items: center; gap: 0.75rem; text-decoration: none; color: inherit; }
        .logo-icon-3d { font-size: 2rem; color: var(--primary-color); text-shadow: 1px 1px 0px var(--secondary-color); transform: rotateY(10deg) rotateX(-5deg); }
        .logo-container h1 { font-size: 1.75rem; font-weight: 700; margin: 0; }

        /* --- MAIN CONTENT --- */
        .tool-container { padding: 2rem; max-width: 1400px; margin: 0 auto; width: 100%; flex: 1; }
        
        .ad-placeholder { 
            max-width: 728px; width: 100%; height: 90px; 
            background-color: #e0e0e0; border: 1px dashed #999; 
            margin: 0 auto 2rem auto; 
            display: flex; align-items: center; justify-content: center; 
            color: #555; border-radius: 8px;
        }

        .tool-header { text-align: center; margin-bottom: 2rem; }
        .tool-header h2 { font-size: 2.2rem; color: var(--primary-color); margin-bottom: 0.5rem; }
        .tool-header p { color: #666; }

        /* --- CONVERTER INTERFACE --- */
        .converter-wrapper {
            display: grid;
            grid-template-columns: 1fr 60px 1fr; /* Left, Middle Controls, Right */
            gap: 20px;
            height: 600px; /* Fixed height for editor feel */
        }

        /* Panels */
        .panel {
            background: var(--surface-color);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .panel-header {
            padding: 15px;
            background: color-mix(in srgb, var(--primary-color) 10%, var(--surface-color));
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: var(--primary-color);
        }

        /* Editors */
        textarea {
            flex: 1;
            width: 100%;
            border: none;
            resize: none;
            padding: 15px;
            font-family: 'Fira Code', monospace;
            font-size: 14px;
            line-height: 1.5;
            background: var(--surface-color);
            color: var(--text-color);
            outline: none;
        }
        textarea:focus { background: color-mix(in srgb, var(--primary-color) 5%, var(--surface-color)); }

        /* JSON Output specific styling */
        #json-output {
            background: var(--code-bg);
            color: var(--code-text);
        }

        /* Middle Controls */
        .controls-column {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        .convert-btn {
            width: 50px; height: 50px;
            border-radius: 50%;
            border: none;
            background: var(--gradient);
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: 0.3s;
            display: flex; align-items: center; justify-content: center;
        }
        .convert-btn:hover { transform: scale(1.1); }
        .convert-btn i { animation: pulse 2s infinite; }

        /* Settings Bar */
        .settings-bar {
            grid-column: 1 / -1;
            background: var(--surface-color);
            padding: 15px 20px;
            border-radius: 8px;
            display: flex;
            gap: 20px;
            align-items: center;
            border: 1px solid var(--border-color);
            flex-wrap: wrap;
        }

        .checkbox-wrapper { display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 0.9rem; }
        
        /* Action Buttons */
        .action-btn {
            padding: 6px 12px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            background: var(--surface-color);
            cursor: pointer;
            font-size: 0.8rem;
            transition: 0.2s;
            color: var(--text-color);
        }
        .action-btn:hover { background: #eee; color: var(--primary-color); }
        
        .btn-primary-action { background: var(--primary-color); color: white; border: none; }
        .btn-primary-action:hover { background: var(--secondary-color); color: white; }

        /* File Upload Hidden Input */
        .file-upload-label {
            cursor: pointer; color: var(--primary-color); font-size: 0.8rem; font-weight: 600;
        }

        /* --- Navigation --- */
        .navigation-buttons { text-align: center; margin-top: 3rem; display: flex; justify-content: center; gap: 1rem; }
        .nav-btn { padding: 0.8rem 2.5rem; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 1.1rem; }
        .nav-back { background: #e9ecef; color: #333; }
        .nav-dash { background: var(--gradient); color: white; }

        /* Responsive */
        @media (max-width: 900px) {
            .converter-wrapper { grid-template-columns: 1fr; height: auto; }
            .controls-column { flex-direction: row; transform: rotate(90deg); height: 60px; }
            .convert-btn i { transform: rotate(-90deg); }
            textarea { height: 300px; }
        }
    </style>
</head>
<body>

    <!-- HEADER -->
    <header class='main-header'>
        <div class='logo-container'>
        
            <h1>JKM Edit</h1>
        </div>
        <div style="display:flex; gap:15px;">
            <!-- Simple Theme Toggle for this demo -->
            <button onclick="document.documentElement.classList.toggle('dark-mode')" style="background:none; border:none; cursor:pointer; font-size:1.2rem; color:var(--text-color);">
                <i class='fa-solid fa-circle-half-stroke'></i>
            </button>
        </div>
    </header>

    <main class='tool-container'>
        <div class="ad-placeholder">Advertisement Space (728x90)</div>

        <div class="tool-header">
            <h2>CSV to JSON Converter</h2>
            <p>Convert Excel/CSV data into clean JSON objects.</p>
        </div>

        <!-- SETTINGS BAR -->
        <div class="settings-bar">
            <label class="checkbox-wrapper">
                <input type="checkbox" id="header-check" checked>
                First row is header
            </label>
            
            <label class="checkbox-wrapper">
                <input type="checkbox" id="minify-check">
                Minify JSON
            </label>

            <label class="checkbox-wrapper">
                <input type="checkbox" id="parse-numbers" checked>
                Parse Numbers
            </label>

            <div style="flex:1"></div> <!-- Spacer -->
            
            <button class="action-btn" onclick="clearAll()">Clear All</button>
        </div>

        <!-- MAIN CONVERTER AREA -->
        <div class="converter-wrapper">
            
            <!-- INPUT: CSV -->
            <div class="panel">
                <div class="panel-header">
                    <span><i class="fa-solid fa-file-csv"></i> CSV Input</span>
                    <div>
                        <input type="file" id="csv-upload" accept=".csv,.txt" style="display:none;" onchange="handleFileUpload(this)">
                        <label for="csv-upload" class="file-upload-label">
                            <i class="fa-solid fa-upload"></i> Upload File
                        </label>
                    </div>
                </div>
                <textarea id="csv-input" placeholder="Paste your CSV data here...&#10;id,name,age&#10;1,John Doe,30&#10;2,Jane Smith,25"></textarea>
            </div>

            <!-- MIDDLE: CONVERT BUTTON -->
            <div class="controls-column">
                <button class="convert-btn" onclick="convertCsvToJson()" title="Convert">
                    <i class="fa-solid fa-arrow-right"></i>
                </button>
            </div>

            <!-- OUTPUT: JSON -->
            <div class="panel">
                <div class="panel-header">
                    <span><i class="fa-brands fa-js"></i> JSON Output</span>
                    <div style="display:flex; gap:5px;">
                        <button class="action-btn" onclick="copyToClipboard()">
                            <i class="fa-regular fa-copy"></i> Copy
                        </button>
                        <button class="action-btn btn-primary-action" onclick="downloadJson()">
                            <i class="fa-solid fa-download"></i> Download
                        </button>
                    </div>
                </div>
                <textarea id="json-output" readonly placeholder="// JSON output will appear here..."></textarea>
            </div>

        </div>

        <!-- FOOTER NAV -->
        <div class="navigation-buttons">
            <a href="javascript:history.back()" class="nav-btn nav-back">
                <i class="fa-solid fa-arrow-left"></i> Go Back
            </a>
            <a href="../../" class="nav-btn nav-dash">
                <i class="fa-solid fa-table-columns"></i> Dashboard
            </a>
        </div>

    </main>

    <script>
        // ELEMENTS
        const csvInput = document.getElementById('csv-input');
        const jsonOutput = document.getElementById('json-output');
        const headerCheck = document.getElementById('header-check');
        const minifyCheck = document.getElementById('minify-check');
        const numbersCheck = document.getElementById('parse-numbers');

        // 1. UPLOAD LOGIC
        function handleFileUpload(input) {
            const file = input.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                csvInput.value = e.target.result;
                convertCsvToJson(); // Auto-convert on upload
            };
            reader.readAsText(file);
        }

        // 2. CONVERSION LOGIC
        function convertCsvToJson() {
            const rawCsv = csvInput.value.trim();
            if (!rawCsv) {
                jsonOutput.value = "";
                return;
            }

            // Use PapaParse for robust parsing
            Papa.parse(rawCsv, {
                header: headerCheck.checked,
                dynamicTyping: numbersCheck.checked, // Auto convert numbers/booleans
                skipEmptyLines: true,
                complete: function(results) {
                    if (results.errors.length > 0) {
                        console.warn("CSV Parsing Errors:", results.errors);
                        // We continue anyway, but you could show an alert
                    }

                    const data = results.data;
                    
                    // Formatting
                    if (minifyCheck.checked) {
                        jsonOutput.value = JSON.stringify(data);
                    } else {
                        jsonOutput.value = JSON.stringify(data, null, 4); // 4 spaces indent
                    }
                },
                error: function(err) {
                    jsonOutput.value = "Error parsing CSV: " + err.message;
                }
            });
        }

        // 3. UTILS
        function copyToClipboard() {
            if (!jsonOutput.value) return;
            jsonOutput.select();
            document.execCommand('copy');
            
            // Button Feedback
            const btn = document.querySelector('button[onclick="copyToClipboard()"]');
            const original = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-check"></i> Copied';
            setTimeout(() => btn.innerHTML = original, 2000);
        }

        function downloadJson() {
            if (!jsonOutput.value) return alert("No JSON to download!");
            
            const blob = new Blob([jsonOutput.value], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "converted_data.json";
            document.body.appendChild(a);
            a.click();
            setTimeout(() => URL.revokeObjectURL(url), 100);
        }

        function clearAll() {
            if(confirm("Clear all data?")) {
                csvInput.value = "";
                jsonOutput.value = "";
                document.getElementById('csv-upload').value = "";
            }
        }

        // Auto-convert on settings change
        headerCheck.addEventListener('change', convertCsvToJson);
        minifyCheck.addEventListener('change', convertCsvToJson);
        numbersCheck.addEventListener('change', convertCsvToJson);
        // Optional: Live typing convert (debounce recommended for large files, but simple here)
        // csvInput.addEventListener('input', convertCsvToJson); 
    </script>
</body>
</html>