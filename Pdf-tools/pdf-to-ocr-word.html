<!DOCTYPE html>
<html lang='en' data-theme='corporate-blue'>
<head>
    <meta charset='UTF-8'/>
    <meta content='width=device-width, initial-scale=1.0' name='viewport'/>
    
    <!-- =================================================================== -->
    <!-- SEO & META TAGS - FOR PDF to OCR WORD TOOL -->
    <!-- =================================================================== -->
    <title>Free PDF to Word with OCR - Convert Scanned PDF | JKM Edit</title>
    <meta name="description" content="Convert your PDF files (up to 5 pages), including scanned documents, to editable Word (DOCX) files using our high-quality online converter. Free, fast, and secure."/>
    <meta name="keywords" content="pdf to word, ocr, pdf to docx, convert pdf, high quality pdf to word, free ocr, online converter, jkm edit"/>
    <meta name="author" content="JKM Edit"/>
    <meta name="robots" content="index, follow"/>
    <link rel="canonical" href="https://jkmpdf.github.io/JKMEDIT/pdf-tools/pdf-to-ocr-word.html"/>
    <meta property="og:title" content="High-Quality PDF to Word with OCR | JKM Edit"/>
    <meta property="og:description" content="Turn any PDF into a perfectly formatted, editable Word document. Our free online tool uses advanced OCR to handle scanned pages with ease."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://jkmpdf.github.io/JKMEDIT/pdf-tools/pdf-to-ocr-word.html"/>
    <meta property="og:image" content="https://jkmpdf.github.io/JKMEDIT/assets/og-preview-image.png"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="High-Quality PDF to Word with OCR | JKM Edit"/>
    <meta name="twitter:description" content="Turn any PDF into a perfectly formatted, editable Word document. Our free online tool uses advanced OCR to handle scanned pages with ease."/>
    <meta name="twitter:image" content="https://jkmpdf.github.io/JKMEDIT/assets/og-preview-image.png"/>
    <!-- =================================================================== -->

    <!-- SCRIPT TO PREVENT THEME AND BACKGROUND FLICKERING (KEEP THIS) -->
    <script>
        (function() {
            try {
                const themeBgColors = {
                    'corporate-blue': { light: '#f4f5f7', dark: '#121212' },'forest-green':   { light: '#f0f3f2', dark: '#121212' },'sunset-gradient':{ light: '#fff8f2', dark: '#121212' },'tech-noir':      { light: '#1a1a2e', dark: '#0f0f1e' },'minty-fresh':    { light: '#f1fefb', dark: '#121212' },'royal-purple':   { light: '#f8f7fa', dark: '#121212' },'graphite-gray':  { light: '#e9ecef', dark: '#121212' },'crimson-red':    { light: '#fdf5f6', dark: '#121212' }
                };
                const theme = localStorage.getItem('jkm-edit-theme') || 'corporate-blue';
                const mode = localStorage.getItem('jkm-edit-mode') || 'light';
                document.documentElement.setAttribute('data-theme', theme);
                if (mode === 'dark') { document.documentElement.classList.add('dark-mode'); }
                const bgColor = (themeBgColors[theme] && themeBgColors[theme][mode]) || '#f4f5f7';
                const style = document.createElement('style');
                style.innerHTML = `html { background-color: ${bgColor} !important; }`;
                document.head.appendChild(style);
            } catch (e) { console.error("Error applying initial theme:", e); }
        })();
    </script>
    
    <link href='https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap' rel='stylesheet'/>
    <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css' rel='stylesheet'/>
    <!-- PDF.js Library for page counting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = `https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js`;</script>


    <style>
        /* All CSS remains identical */
        :root { font-family: 'Poppins', sans-serif; --transition-speed: 0.3s; }
        html { background-color: var(--bg-color); }
        body { margin: 0; background-color: var(--bg-color); color: var(--text-color); transition: background-color var(--transition-speed), color var(--transition-speed); }
        *, *::before, *::after { box-sizing: border-box; }
        .hidden { display: none !important; }
        [data-theme='corporate-blue'] { --primary-color: #0052cc; --secondary-color: #0747a6; --bg-color: #f4f5f7; --surface-color: #ffffff; --text-color: #172b4d; --accent-color: #ffab00; --gradient: linear-gradient(45deg, var(--primary-color), #0065ff); }
        [data-theme='forest-green'] { --primary-color: #28a745; --secondary-color: #218838; --bg-color: #f0f3f2; --surface-color: #ffffff; --text-color: #343a40; --accent-color: #ffc107; --gradient: linear-gradient(45deg, var(--primary-color), #34d058); }
        [data-theme='sunset-gradient'] { --primary-color: #fd7e14; --secondary-color: #e65100; --bg-color: #fff8f2; --surface-color: #ffffff; --text-color: #492b0e; --accent-color: #20c997; --gradient: linear-gradient(45deg, #ff4e50, #f9d423); }
        [data-theme='tech-noir'] { --primary-color: #e83e8c; --secondary-color: #d81b60; --bg-color: #1a1a2e; --surface-color: #242444; --text-color: #e0e0e0; --accent-color: #00bcd4; --gradient: linear-gradient(45deg, #4a00e0, #8e2de2); }
        [data-theme='minty-fresh'] { --primary-color: #1abc9c; --secondary-color: #16a085; --bg-color: #f1fefb; --surface-color: #ffffff; --text-color: #3d524d; --accent-color: #f39c12; --gradient: linear-gradient(45deg, #1abc9c, #1dd3b0); }
        [data-theme='royal-purple'] { --primary-color: #6f42c1; --secondary-color: #5a32a3; --bg-color: #f8f7fa; --surface-color: #ffffff; --text-color: #343a40; --accent-color: #fd7e14; --gradient: linear-gradient(45deg, #6f42c1, #8a5fd6); }
        [data-theme='graphite-gray'] { --primary-color: #6c757d; --secondary-color: #5a6268; --bg-color: #e9ecef; --surface-color: #f8f9fa; --text-color: #212529; --accent-color: #007bff; --gradient: linear-gradient(45deg, #6c757d, #adb5bd); }
        [data-theme='crimson-red'] { --primary-color: #dc3545; --secondary-color: #c82333; --bg-color: #fdf5f6; --surface-color: #ffffff; --text-color: #343a40; --accent-color: #ffc107; --gradient: linear-gradient(45deg, #dc3545, #f05a68); }
        html.dark-mode { --bg-color: #121212; --surface-color: #1e1e1e; --text-color: #e0e0e0; }
        .main-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem; background: var(--surface-color); box-shadow: 0 2px 10px rgba(0,0,0,0.1); border-bottom: 3px solid var(--primary-color); z-index: 100; position: sticky; top: 0; }
        .logo-container { display: flex; align-items: center; gap: 0.75rem; }
        .logo-icon-3d { font-size: 2rem; color: var(--primary-color); text-shadow: 1px 1px 0px var(--secondary-color), 2px 2px 0px rgba(0,0,0,0.1); transform: rotateY(10deg) rotateX(-5deg); }
        .logo-container h1 { font-size: 1.75rem; font-weight: 700; margin: 0; color: var(--text-color); }
        .main-nav { display: flex; align-items: center; gap: 1.5rem; }
        .nav-link { text-decoration: none; color: var(--text-color); font-weight: 600; position: relative; } .nav-link::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -5px; left: 0; background-color: var(--primary-color); transition: width .3s; } .nav-link:hover::after { width: 100%; } #theme-picker { padding: 0.25rem 0.5rem; border-radius: 5px; border: 1px solid var(--primary-color); background: var(--surface-color); color: var(--text-color); } #dark-mode-toggle { background: none; border: none; cursor: pointer; font-size: 1.25rem; color: var(--text-color); padding: 0.5rem; } #dark-mode-toggle .fa-sun { display: none; } html.dark-mode #dark-mode-toggle .fa-sun { display: inline; } html.dark-mode #dark-mode-toggle .fa-moon { display: none; }
        .modal { display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); backdrop-filter: blur(5px); animation: fadeIn 0.3s; } .modal.show-modal { display: flex; align-items: center; justify-content: center; } .modal-content { background-color: var(--surface-color); margin: auto; padding: 30px; border-top: 5px solid var(--primary-color); border-radius: 8px; width: 90%; max-width: 500px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); position: relative; animation: slideIn 0.4s ease-out; } .close-btn { color: #aaa; position: absolute; top: 10px; right: 20px; font-size: 28px; font-weight: bold; cursor: pointer; } .contact-email { display: inline-block; margin-top: 1rem; padding: 0.75rem 1.5rem; background: var(--gradient); color: white; text-decoration: none; border-radius: 5px; font-weight: 600; } @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } } @keyframes slideIn { from { transform: translateY(-50px); opacity: 0; } to { translateY(0); opacity: 1; } }
        .tool-container { padding: 2rem 4rem; max-width: 900px; margin: auto; }
        .tool-header h2 { font-size: 2.5rem; margin-bottom: 0.5rem; text-align: center; }
        .tool-header p { font-size: 1.1rem; color: #6c757d; text-align: center; margin-bottom: 2rem; }
        html.dark-mode .tool-header p { color: #a0a0a0; }
        #dropzone { border: 3px dashed #ccc; border-radius: 15px; padding: 3rem; text-align: center; cursor: pointer; background-color: var(--surface-color); transition: background-color var(--transition-speed), border-color var(--transition-speed); }
        #dropzone:hover { border-color: var(--primary-color); }
        #dropzone i { font-size: 3rem; color: var(--primary-color); margin-bottom: 1rem; }
        #processing-panel { margin-top: 2rem; padding: 2rem; background: var(--surface-color); border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); display: flex; flex-direction: column; gap: 1.5rem; align-items: center; }
        .file-info-card { font-weight: 600; font-size: 1.1rem; color: var(--text-color); background: var(--bg-color); padding: 0.75rem 1.5rem; border-radius: 8px; width: 100%; text-align: center; word-break: break-all; }
        .action-button { display: inline-flex; align-items: center; justify-content: center; gap: 0.75rem; width: 100%; max-width: 500px; padding: 1rem; font-size: 1.25rem; font-weight: 600; color: white; background: var(--gradient); border: none; border-radius: 8px; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; }
        .action-button:disabled { background: #ccc; cursor: not-allowed; }
        .action-button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .progress-container { width: 100%; max-width: 500px; text-align: center; }
        .progress-bar { width: 100%; height: 20px; background-color: var(--bg-color); border-radius: 10px; overflow: hidden; border: 1px solid #ccc; margin-top: 1rem; }
        .progress-bar-fill { width: 0%; height: 100%; background: var(--gradient); transition: width 0.4s ease-out; }
        #progress-text { font-weight: 600; color: var(--primary-color); margin-bottom: 0.5rem; font-size: 1rem; }
        .quote-container { margin-top: 1.5rem; padding: 1rem; background: var(--bg-color); border-left: 4px solid var(--accent-color); width: 100%; max-width: 500px; }
        .quote-container p { margin: 0; font-style: italic; color: #6c757d; transition: opacity 0.5s ease-in-out; }
        html.dark-mode .quote-container p { color: #a0a0a0; }
        .quote-fade { opacity: 0; }
        
        /* ===== START: AD BOX STYLES ===== */
        .ad-placeholder-box {
            width: 728px;
            max-width: 100%; /* Ensure it doesn't overflow on smaller containers */
            min-height: 90px;
            background-color: #f0f0f0;
            border: 1px dashed #ccc;
            margin: 0 auto 2rem auto; /* top, horizontal-auto, bottom, horizontal-auto */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #888;
            font-family: Arial, sans-serif;
            border-radius: 8px;
        }
        .ad-placeholder-box .ad-text {
            font-size: 1rem;
            font-weight: bold;
        }
        .ad-placeholder-box .ad-size {
            font-size: 0.8rem;
            margin-top: 4px;
        }
        html.dark-mode .ad-placeholder-box {
            background-color: #2a2a2a;
            border-color: #444;
            color: #aaa;
        }
        /* ===== END: AD BOX STYLES ===== */

        .navigation-buttons { display: flex; justify-content: center; align-items: center; gap: 1rem; text-align: center; margin-top: 3rem; }
        .nav-btn { display: inline-block; padding: 0.8rem 2.5rem; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 1.1rem; }
        .primary-nav-btn { background: var(--gradient); color: white !important; }
        .back-secondary-btn { background: transparent; color: var(--primary-color) !important; border: 2px solid var(--primary-color); }
        body { animation: fadeInPage 0.5s ease-in-out; }
        .fade-out { animation: fadeOutPage 0.4s ease-in-out forwards; }
        @keyframes fadeInPage { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeOutPage { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(10px); } }
        @media (max-width: 768px) { 
            .tool-container { padding: 2rem 1.5rem; } 
            .main-header { flex-direction: column; gap: 1rem; }
            /* Make ad box responsive */
            .ad-placeholder-box {
                width: 100%;
                min-height: 100px;
            }
        }
    </style>
</head>
<body>
    <header class='main-header'>
        <div class='logo-container'><a href='/' style='text-decoration: none; color: inherit; display: flex; align-items: center; gap: 0.75rem;'><div class='logo-icon-3d'><i class='fa-solid fa-cube'></i></div><h1>JKM Edit</h1></a></div>
        <nav class='main-nav'><div class='theme-selector'><label for='theme-picker'>Theme:</label><select id='theme-picker'><option value='corporate-blue'>Corporate Blue</option><option value='forest-green'>Forest Green</option><option value='sunset-gradient'>Sunset Gradient</option><option value='tech-noir'>Tech Noir</option><option value='minty-fresh'>Minty Fresh</option><option value='royal-purple'>Royal Purple</option><option value='graphite-gray'>Graphite Gray</option><option value='crimson-red'>Crimson Red</option></select></div><button id='dark-mode-toggle' class='nav-button' aria-label='Toggle Dark Mode'><i class='fa-solid fa-moon'></i><i class='fa-solid fa-sun'></i></button><a href='#' id='about-btn' class='nav-link'>About</a><a href='#' id='contact-btn' class='nav-link'>Contact Us</a></nav>
    </header>

    <main class='tool-container'>

        <!-- ===== START: AD BOX PLACEHOLDER ===== -->
        <div class="ad-placeholder-box">
            <span class="ad-text"><script type="text/javascript">
	atOptions = {
		'key' : 'ee4e31cf24b130732767b94f62d603a1',
		'format' : 'iframe',
		'height' : 90,
		'width' : 728,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/ee4e31cf24b130732767b94f62d603a1/invoke.js"></script></span></span>
        </div>
        <!-- ===== END: AD BOX PLACEHOLDER ===== -->

        <div id="upload-stage">
            <div class='tool-header'>
                <h2>PDF to Word Converter</h2>
                <p>Convert your PDFs (max 5 pages) & images into perfectly formatted Word documents.</p>
            </div>
            <input type="file" id="file-input" class="hidden" accept=".pdf,.png,.jpg,.jpeg,.tiff"/>
            <div id="dropzone">
                <i class="fa-solid fa-file-arrow-up"></i>
                <p id="dropzone-text">Drag & drop PDF (max 5 pages) or Image here</p>
            </div>
        </div>

        <div id="processing-panel" class="hidden">
             <!-- Content generated by JavaScript -->
        </div>
        
        <div class="navigation-buttons">
            <a href="/pdf-tools.html" class="nav-btn back-secondary-btn"><i class="fa-solid fa-arrow-left"></i> Go Back</a>
            <a href="/" class="nav-btn primary-nav-btn"><i class="fa-solid fa-table-columns"></i> Dashboard</a>
        </div>
    </main>
    
    <div id='about-modal' class='modal'><div class='modal-content'><span class='close-btn'>×</span><h2>About JKM Edit</h2><p>JKM Edit is your all-in-one solution for online file manipulation.</p></div></div>
    <div id='contact-modal' class='modal'><div class='modal-content'><span class='close-btn'>×</span><h2>Contact Us</h2><p>You can email us directly at:</p><a href='mailto:Mpurohit2414@gmail.com' class='contact-email'>Mpurohit2414@gmail.com</a></div></div>

    <!-- [START] --- UNIVERSAL PAGE SCRIPT (DE-MINIFIED & ROBUST) --- -->
    <script>
        // Handle the back/forward cache to prevent showing a faded-out page
        window.addEventListener('pageshow', function (event) {
            if (event.persisted) {
                document.body.classList.remove('fade-out');
            }
        });

        // Run all setup logic after the document is fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            const docElement = document.documentElement;

            // --- Theme & Dark Mode Logic ---
            const themePicker = document.getElementById('theme-picker');
            const darkModeToggle = document.getElementById('dark-mode-toggle');

            const applyTheme = (themeName) => {
                docElement.dataset.theme = themeName;
                localStorage.setItem('jkm-edit-theme', themeName);
            };

            const enableDarkMode = () => {
                docElement.classList.add('dark-mode');
                localStorage.setItem('jkm-edit-mode', 'dark');
            };

            const disableDarkMode = () => {
                docElement.classList.remove('dark-mode');
                localStorage.setItem('jkm-edit-mode', 'light');
            };

            // Setup Theme Picker
            if (themePicker) {
                const savedTheme = localStorage.getItem('jkm-edit-theme') || 'corporate-blue';
                themePicker.value = savedTheme;
                docElement.dataset.theme = savedTheme;
                themePicker.addEventListener('change', () => applyTheme(themePicker.value));
            }

            // Setup Dark Mode Toggle
            if (darkModeToggle) {
                if (localStorage.getItem('jkm-edit-mode') === 'dark') {
                    enableDarkMode();
                }
                darkModeToggle.addEventListener('click', () => {
                    docElement.classList.contains('dark-mode') ? disableDarkMode() : enableDarkMode();
                });
            }

            // --- Modal Logic ---
            const aboutModal = document.getElementById('about-modal');
            const contactModal = document.getElementById('contact-modal');
            const aboutBtn = document.getElementById('about-btn');
            const contactBtn = document.getElementById('contact-btn');
            const closeBtns = document.querySelectorAll('.close-btn');

            const showModal = (modal) => modal.classList.add('show-modal');
            const hideModal = (modal) => modal.classList.remove('show-modal');

            if (aboutBtn) aboutBtn.addEventListener('click', (e) => { e.preventDefault(); showModal(aboutModal); });
            if (contactBtn) contactBtn.addEventListener('click', (e) => { e.preventDefault(); showModal(contactModal); });

            closeBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    if (aboutModal) hideModal(aboutModal);
                    if (contactModal) hideModal(contactModal);
                });
            });

            window.addEventListener('click', (e) => {
                if (e.target === aboutModal) hideModal(aboutModal);
                if (e.target === contactModal) hideModal(contactModal);
            });

            // --- Page Navigation Fade Effect ---
            document.querySelectorAll('a').forEach(link => {
                const href = link.getAttribute('href');
                if (href && !href.startsWith('#') && !href.startsWith('mailto:') && !href.startsWith('javascript:')) {
                    link.addEventListener('click', function (event) {
                        event.preventDefault();
                        document.body.classList.add('fade-out');
                        // Use the browser's fully resolved 'href' property for maximum reliability
                        setTimeout(() => { window.location.href = this.href; }, 400);
                    });
                }
            });
        });
    </script>
    <!-- [END] --- UNIVERSAL PAGE SCRIPT --- -->


    <!-- [START] --- PDF TO WORD LOGIC (ASYNC VERSION) --- -->
    <script>
        // ALL JAVASCRIPT LOGIC REMAINS UNCHANGED.
        const fileInput = document.getElementById('file-input');
        const dropzone = document.getElementById('dropzone');
        const uploadStage = document.getElementById('upload-stage');
        const processingPanel = document.getElementById('processing-panel');
        const MAX_PAGES = 5;
      const API_BASE_URL = 'https://jkm-edit-backend.onrender.com'; // YOUR NEW URL
        let uploadedFile = null;
        let pollingInterval = null; 
        let quoteInterval = null;
        dropzone.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', e => handleFile(e.target.files[0]));
        dropzone.addEventListener('dragover', e => { e.preventDefault(); dropzone.style.borderColor = 'var(--primary-color)'; });
        dropzone.addEventListener('dragleave', () => dropzone.style.borderColor = '#ccc');
        dropzone.addEventListener('drop', e => {
            e.preventDefault();
            dropzone.style.borderColor = '#ccc';
            handleFile(e.dataTransfer.files[0]);
        });
        async function handleFile(file) {
            const allowedTypes = ['application/pdf', 'image/png', 'image/jpeg', 'image/tiff'];
            if (!file || !allowedTypes.includes(file.type)) {
                alert("Please select a PDF or Image file (PNG, JPG, TIFF).");
                return;
            }
            if (file.type === 'application/pdf') {
                const pageCount = await getPdfPageCount(file).catch(() => -1);
                if (pageCount === -1) {
                    alert("Could not read this PDF. It may be protected or corrupt.");
                    return;
                }
                if (pageCount > MAX_PAGES) {
                    alert(`PDFs are limited to ${MAX_PAGES} pages. Your file has ${pageCount} pages.`);
                    return;
                }
            }
            uploadedFile = file;
            uploadStage.classList.add('hidden');
            processingPanel.classList.remove('hidden');
            processingPanel.innerHTML = `
                <div class="file-info-card">
                    <i class="fa-solid fa-file-alt"></i> ${uploadedFile.name}
                </div>
                <button id="convert-btn" class="action-button">
                    <i class="fa-solid fa-file-word"></i> Convert to Word
                </button>
            `;
            document.getElementById('convert-btn').addEventListener('click', startConversionProcess);
        }
        async function getPdfPageCount(file) {
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
            return pdf.numPages;
        }
        function startConversionProcess() {
            if (!uploadedFile) return;
            processingPanel.innerHTML = `
                <div class="progress-container">
                    <p id="progress-text">Uploading file...</p>
                    <div class="progress-bar"><div id="progress-bar-fill" class="progress-bar-fill" style="width: 50%;"></div></div>
                </div>
                <div id="quote-container" class="quote-container hidden">
                    <p style="font-size:0.9rem; font-weight:bold; margin-bottom: 0.5rem;">Waiting can be boring... here's a thought:</p>
                    <p id="quote-text"></p>
                </div>
            `;
            const formData = new FormData();
            formData.append('file', uploadedFile);
            fetch(`${API_BASE_URL}/api/ocr/upload`, {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(err => { throw new Error(err.error || 'Upload failed.') });
                }
                return response.json();
            })
            .then(data => {
                if (data.jobId) {
                    document.getElementById('progress-text').textContent = 'File received! Starting conversion...';
                    document.getElementById('progress-bar-fill').style.width = '100%';
                    document.getElementById('quote-container').classList.remove('hidden');
                    startQuoteCarousel(document.getElementById('quote-text'));
                    pollForStatus(data.jobId);
                } else {
                    throw new Error(data.error || 'Server did not provide a job ID.');
                }
            })
            .catch(error => {
                console.error('Upload failed:', error);
                displayError(error.message);
            });
        }
        function pollForStatus(jobId) {
            pollingInterval = setInterval(async () => {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/ocr/status/${jobId}`);
                    if (!response.ok) throw new Error('Status check failed');
                    const result = await response.json();
                    if (result.status === 'COMPLETED') {
                        clearInterval(pollingInterval);
                        stopQuoteCarousel();
                        document.getElementById('progress-text').textContent = 'Conversion Complete!';
                        displayDownloadButton(jobId);
                    } else if (result.status === 'FAILED') {
                        clearInterval(pollingInterval);
                        stopQuoteCarousel();
                        displayError(result.error || 'The conversion failed on the server.');
                    } else {
                        console.log(`Job status: ${result.status}`);
                        document.getElementById('progress-text').textContent = `Server is working... (Status: ${result.status})`;
                    }
                } catch (error) {
                    clearInterval(pollingInterval);
                    stopQuoteCarousel();
                    displayError('Lost connection to the server.');
                }
            }, 5000);
        }
        function displayDownloadButton(jobId) {
            const downloadUrl = `${API_BASE_URL}/api/ocr/download/${jobId}`;
            processingPanel.innerHTML = `
                <div class="file-info-card" style="border-left: 5px solid var(--primary-color);">
                    <i class="fa-solid fa-check-circle" style="color: #28a745;"></i> Conversion Complete!
                </div>
                <a class="action-button" href="${downloadUrl}">
                    <i class="fa-solid fa-download"></i> Download Word File
                </a>
                <button id="restart-btn" class="action-button" style="background: var(--secondary-color); margin-top: 1rem;">Convert Another File</button>
            `;
            document.getElementById('restart-btn').addEventListener('click', resetTool);
        }
        function displayError(errorMessage) {
            if (pollingInterval) clearInterval(pollingInterval);
            stopQuoteCarousel();
            processingPanel.innerHTML = `
                <p style="color:red; text-align:center; font-weight:bold;">Conversion Failed</p>
                <p style="text-align:center;">${errorMessage}</p>
                <button id="retry-btn" class="action-button">Try Again with a Different File</button>
            `;
            document.getElementById('retry-btn').addEventListener('click', resetTool);
        }
        function resetTool() {
            if (pollingInterval) clearInterval(pollingInterval);
            stopQuoteCarousel();
            uploadStage.classList.remove('hidden');
            processingPanel.classList.add('hidden');
            processingPanel.innerHTML = '';
            uploadedFile = null;
            fileInput.value = '';
        }
        const QUOTES = [
            "The secret of getting ahead is getting started.", "The best time to plant a tree was 20 years ago. The second best time is now.", "It’s not whether you get knocked down, it’s whether you get up.", "The only way to do great work is to love what you do.", "Believe you can and you’re halfway there.", "Act as if what you do makes a difference. It does.", "Success is not final, failure is not fatal: it is the courage to continue that counts.", "Never bend your head. Always hold it high. Look the world straight in the eye.", "What you get by achieving your goals is not as important as what you become by achieving your goals.", "The journey of a thousand miles begins with a single step."
        ];
        let shuffledQuotes = [];
        let quoteIndex = 0;
        function startQuoteCarousel(element) {
            shuffledQuotes = [...QUOTES].sort(() => 0.5 - Math.random());
            quoteIndex = 0;
            const displayNextQuote = () => {
                element.classList.add('quote-fade');
                setTimeout(() => {
                    element.textContent = `“${shuffledQuotes[quoteIndex]}”`;
                    element.classList.remove('quote-fade');
                    quoteIndex = (quoteIndex + 1) % shuffledQuotes.length;
                }, 500);
            };
            displayNextQuote();
            quoteInterval = setInterval(displayNextQuote, 10000);
        }
        function stopQuoteCarousel() {
            if (quoteInterval) {
                clearInterval(quoteInterval);
                quoteInterval = null;
            }
        }
    </script>
    <!-- [END] --- PDF TO WORD LOGIC --- -->
</body>
</html>
